{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Smile Cleaning Products - signin</title>
  <!-- CSS -->
  <link rel="stylesheet" href="{% static 'css/newdesign.css' %}" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
  <style>
    .auth-container { max-width: 400px; margin: 50px auto; padding: 30px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); background: #fff; }
    .auth-container h2 { text-align: center; margin-bottom: 20px; }
    .auth-container input { width: 100%; padding: 12px; margin: 10px 0; border-radius: 8px; border: 1px solid #ccc; }
    .btn-submit { width: 100%; padding: 12px; background-color: #4CAF50; color: white; border: none; border-radius: 8px; font-weight: 600; cursor: pointer; font-size: 16px; transition: 0.3s; }
    .btn-submit:hover { background-color: #45a049; }
    .message { text-align: center; margin: 10px 0; padding: 10px; border-radius: 8px; }
    .message.success { background-color: #d4edda; color: #155724; }
    .message.error { background-color: #f8d7da; color: #721c24; }
    .back-link { display: block; text-align: center; margin-top: 15px; color: #333; text-decoration: none; }
    .back-link:hover { text-decoration: underline; }
  </style>
<body data-user="{% if request.user.is_authenticated %}{{ request.user.first_name }}{% endif %}">


  <!-- NAVBAR -->
  <header class="navbar">
    <div class="nav-left">
      <a style="display:flex;align-items:center;gap:10px;">
        <img src="{% static 'images/smilelogo.JPG' %}" alt="logo" class="logo" />
        <div class="logo-text">SMILE</div>
      </a>
<div id="user-banner" class="user-banner-inline"></div>

    </div>


  </header>


  <!-- MAIN -->
<div class="auth-container">
  <h2>Reset Password</h2>

  {% if messages %}
    {% for msg in messages %}
      <div class="message {% if msg.tags %}{{ msg.tags }}{% endif %}">{{ msg }}</div>
    {% endfor %}
  {% endif %}

  {% if not password_reset_done %}
    <form method="POST">
      {% csrf_token %}
      <input type="password" name="password1" placeholder="New password" required>
      <input type="password" name="password2" placeholder="Confirm password" required>
      <button type="submit" class="btn-submit">Reset Password</button>
    </form>
  {% else %}

  {% endif %}
</div>


  <!-- FOOTER -->
  <footer class="footer">
    <div class="footer-content">
      <h3 class="footer-title">Smile Cleaning Products</h3>
      <ul class="footer-links">
        <li>Home</li>
        <li>About Us</li>
        <li>Contact</li>
        <li>Products</li>
      </ul>
      <div class="footer-icons">
        <a href="https://facebook.com" target="_blank"><i class="fa-brands fa-facebook"></i></a>
        <a href="https://instagram.com" target="_blank"><i class="fa-brands fa-instagram"></i></a>
        <a href="https://tiktok.com" target="_blank"><i class="fa-brands fa-tiktok"></i></a>
      </div>
      <p class="footer-copy">© 2025 Smile Cleaning Products — All Rights Reserved.</p>
    </div>
  </footer>
<script>
  // Only run if password reset was successful
  if ({{ password_reset_done|yesno:"true,false" }}) {
    // Replace current state to remove reset URL
    window.history.replaceState({}, document.title, "{% url 'home' %}");

    // Redirect if user tries to go back or the page is loaded from bfcache
    window.onpageshow = function(event) {
      if (event.persisted || window.performance.navigation.type === 2) {
        window.location.href = "{% url 'home' %}";
      }
    };

    window.onpopstate = function() {
      window.location.href = "{% url 'home' %}";
    };
  }
</script>
  <script>
    window.USER_LOGGED_IN = {{ request.user.is_authenticated|yesno:"true,false" }};
    document.addEventListener("DOMContentLoaded", () => { showUser(); });
  </script>
  <script src="{% static 'js/main.js' %}"></script>
</body>
</html>
